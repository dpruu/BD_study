# [실기 준비] 작업형2

> 백화점 고객의 1년 간 구매 데이터
>
> - 고객 3,500명에 대한 학습용 데이터(y_train, X_train)를 이용해 성별예측 모형을 만든 후 이를 평가용 데이터 (X_test)에 적용해 얻은 2,482명 고객의 성별 예측값(남자일 확률)을 다음과 같은 형식의 CSV파일로 생성
> - 적절한 데이터 전처리, Feature Engineering, 분류 알고리즘 사용, 초매개변수 최적화, 모형 앙상블 등이 수반되어야 한다.
> - 수험번호.csv파일이 만들어지도록 코드 제출
> - 제출 모델은 ROC-AUC 평가지표에 따라 채점
> - dataset은 data/y_train.csv 형태로 읽어들인다



## 라이브러리 및 데이터 불러오기

```python
import pandas as pd
from sklearn.preprocessing import LabelEncoder
from sklearn.impute import SimpleImputer

X = pd.read_csv('.../X_train.csv', sep= ',', encoding = 'CP949')
test = pd.read_csv('.../X_test.csv', sep= ',', encoding = 'CP949')
y = pd.read_csv('.../y_train.csv', sep= ',', encoding = 'CP949')
```

![image-20211109151718903](markdown-images/image-20211109151718903.png)



## EDA

```python
# 결측지 제거
# 환불금액 col만 결측치, 0으로 대체
X = X.fillna(0)
test = test.fillna(0)

# cust_id는 예측에 필요없으므로 제거
X = X.drop(['cust_id'],axis =1)
cust_id = test.pop('cust_id')
```

![image-20211109151448529](markdown-images/image-20211109151448529.png)

```python
from sklearn.preprocessing import LabelEncoder

cols = ['주구매상품','주구매지점']
for col in cols:
  le = LabelEncoder()
  X[col] = le.fit_transform(X[col])
  test[col] = le.fit_transform(test[col])

# 다른 방식
# x_train.loc[:,['주구매상품','주구매지점']] = \
# x_train.loc[:,['주구매상품','주구매지점']].apply(LabelEncoder().fit_transform)
```



# 모델링, 하이퍼파라미터 튜닝 & 앙상블

```python
from sklearn.ensemble import RandomForestClassifier

md = RandomForestClassifier(random_state = 2022, n_estimators = 100, max_depth = 10)
md.fit(X,y['gender'])
predictions = md.predict_proba(test)

output = pd.DataFrame({'cust_id':cust_id, 'gender':predictions[:,1]})
output.to_csv('0000.csv', index=False)

output
```

![image-20211109152130158](markdown-images/image-20211109152130158.png)

